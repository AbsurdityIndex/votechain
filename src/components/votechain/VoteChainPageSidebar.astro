---
import Icon from '../ui/Icon.astro';
import { VOTECHAIN_PRIMARY_NAV, VOTECHAIN_EVIDENCE_BOARDS } from '../../utils/votechain-nav';

interface Props {
  currentPath: string;
}

const { currentPath } = Astro.props;

function normalize(path: string) {
  return path.endsWith('/') && path !== '/' ? path.slice(0, -1) : path;
}

function isActive(href: string) {
  const p = normalize(currentPath);
  const h = normalize(href);
  if (h === '/votechain') return p === '/votechain';
  return p === h || p.startsWith(`${h}/`);
}

---

<aside
  class="hidden xl:block xl:sticky bg-white border border-navy-200 rounded-lg p-4 overflow-y-auto"
  style="top: calc(var(--layout-content-top, 96px) + 0.75rem); max-height: calc(100dvh - var(--layout-content-top, 96px) - 1.5rem);"
>
  <p class="text-xs font-mono uppercase tracking-widest text-gold-600 mb-3">VoteChain Pages</p>
  <nav aria-label="VoteChain pages" class="space-y-1.5 text-sm">
    {
      VOTECHAIN_PRIMARY_NAV.map((link) => {
        const active = isActive(link.href);
        return (
          <a
            href={link.href}
            class:list={[
              'flex items-center gap-2 rounded px-2.5 py-1.5 transition-colors',
              active
                ? 'bg-gold-50 dark:bg-gold-800/20 text-navy-900 font-semibold'
                : 'text-navy-700 hover:text-gold-700 hover:bg-cream-50 dark:hover:bg-cream-300/10',
            ]}
          >
            <Icon name={link.icon as any} size={15} class={active ? 'text-gold-700' : 'text-navy-500'} />
            {link.label}
          </a>
        );
      })
    }
  </nav>

  <p class="text-xs font-mono uppercase tracking-widest text-gold-600 mt-5 mb-3">Evidence Boards</p>
  <nav aria-label="Evidence boards" class="space-y-1.5 text-sm">
    {
      VOTECHAIN_EVIDENCE_BOARDS.map((link) => {
        const active = isActive(link.href);
        return (
          <a
            href={link.href}
            class:list={[
              'flex items-center gap-2 rounded px-2.5 py-1.5 transition-colors',
              active
                ? 'bg-gold-50 dark:bg-gold-800/20 text-navy-900 font-semibold'
                : 'text-navy-700 hover:text-gold-700 hover:bg-cream-50 dark:hover:bg-cream-300/10',
            ]}
          >
            <Icon name={link.icon as any} size={15} class={active ? 'text-gold-700' : 'text-navy-500'} />
            {link.label}
          </a>
        );
      })
    }
  </nav>
</aside>
