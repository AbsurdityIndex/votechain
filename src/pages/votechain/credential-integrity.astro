---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Icon from '../../components/ui/Icon.astro';
import Divider from '../../components/ui/Divider.astro';
---

<BaseLayout
  title="Credential Integrity â€” Rogue Issuance Defense"
  description="How VoteChain prevents rogue credential minting via threshold issuance and voter roll commitments. A root architectural concern and its cryptographic solution."
  ogType="article"
  article={{
    publishedTime: '2026-02-08',
    author: 'Absurdity Index',
    section: 'Policy',
    tags: ['votechain', 'credential integrity', 'threshold issuance', 'voter roll', 'election security'],
  }}
>
  <div class="max-w-4xl mx-auto px-4 py-8">
    <div class="text-center mb-6">
      <p class="text-xs text-gold-600 font-mono uppercase tracking-widest mb-1">
        Root Architectural Concern
      </p>
      <h1 class="font-serif text-2xl md:text-3xl text-navy-900 font-bold">
        Credential Integrity
      </h1>
      <p class="text-navy-600 font-serif italic mt-2 text-sm">
        What stops a registration authority from minting unlimited voter credentials?
      </p>
    </div>

    <div class="bg-parchment rounded-lg shadow-lg p-8 md:p-12">
      <div class="bill-content prd-content">

        <!-- The Problem -->
        <section class="mb-10">
          <h2 class="font-serif text-xl text-navy-900 font-bold flex items-center gap-2 mb-4">
            <Icon name="alert-triangle" class="text-gold-600" />
            The Problem: Rogue Credential Minting
          </h2>

          <p class="text-navy-700 text-sm mb-4">
            Blind Schnorr signatures provide a powerful privacy property: the registration authority
            (issuer) cannot link a credential to a specific voter after issuance. This is essential for
            ballot secrecy. However, <strong>the same property that makes credentials unlinkable also makes
            it impossible to audit how many credentials a single authority issued.</strong>
          </p>

          <div class="rounded-lg border border-red-200 bg-red-50 p-5 mb-6">
            <p class="font-sans font-bold text-red-800 text-sm mb-2">The attack:</p>
            <ol class="text-red-800 text-sm list-decimal ml-5 space-y-1.5">
              <li>A rogue registration authority holds the issuer private key (<code>sk_I</code>).</li>
              <li>They generate fake voter keypairs and run the blind Schnorr ceremony <em>with themselves</em>.</li>
              <li>Each fake credential produces a <strong>unique nullifier</strong> (since <code>nullifier = SHA-256(voter_pk || election_id)</code>).</li>
              <li>They hand N credentials to a bad actor &mdash; that actor casts N valid ballots.</li>
              <li>The blinding property makes these credentials <strong>indistinguishable from legitimate ones</strong>.</li>
            </ol>
          </div>

          <p class="text-navy-700 text-sm mb-4">
            This is a fundamental tension in cryptographic voting: <strong>privacy vs. auditability at the
            issuance layer</strong>. Blind signatures were originally designed by Chaum (1983) for e-cash,
            where the bank is economically incentivized not to over-mint. In voting, the "bank" (registration
            authority) may have <em>political</em> incentive to do exactly the opposite.
          </p>

          <h3 class="font-serif text-lg text-navy-900 font-semibold mt-6 mb-3">Why existing defenses are insufficient</h3>

          <div class="overflow-x-auto">
            <table class="w-full text-sm border border-navy-200 rounded-lg overflow-hidden">
              <thead class="bg-navy-800 text-cream-100">
                <tr>
                  <th class="px-4 py-2 text-left font-mono text-xs uppercase">Mechanism</th>
                  <th class="px-4 py-2 text-left font-mono text-xs uppercase">Does it help?</th>
                  <th class="px-4 py-2 text-left font-mono text-xs uppercase">Why not?</th>
                </tr>
              </thead>
              <tbody class="text-navy-700">
                <tr class="border-b border-navy-100">
                  <td class="px-4 py-2 font-semibold">Nullifier dedup</td>
                  <td class="px-4 py-2">Prevents one credential from voting twice</td>
                  <td class="px-4 py-2">Does NOT limit how many credentials exist</td>
                </tr>
                <tr class="border-b border-navy-100 bg-cream-50">
                  <td class="px-4 py-2 font-semibold">VCL event logging</td>
                  <td class="px-4 py-2">Logs each <em>ballot cast</em></td>
                  <td class="px-4 py-2">Cannot log credential issuance without breaking unlinkability</td>
                </tr>
                <tr class="border-b border-navy-100">
                  <td class="px-4 py-2 font-semibold">Bulletin board</td>
                  <td class="px-4 py-2">Proves ballots exist</td>
                  <td class="px-4 py-2">Cannot distinguish legitimate vs. rogue ballots</td>
                </tr>
                <tr class="bg-cream-50">
                  <td class="px-4 py-2 font-semibold">Threshold decryption</td>
                  <td class="px-4 py-2">Protects ballot secrecy</td>
                  <td class="px-4 py-2">Irrelevant to credential count</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <Divider withSeal={false} />

        <!-- The Solution -->
        <section class="mb-10 mt-8">
          <h2 class="font-serif text-xl text-navy-900 font-bold flex items-center gap-2 mb-4">
            <Icon name="shield" class="text-gold-600" />
            The Solution: Two-Layer Defense
          </h2>

          <p class="text-navy-700 text-sm mb-6">
            VoteChain addresses rogue credential minting with two complementary mechanisms that together
            transform the trust model from "one honest authority" to "threshold collusion resistance with
            public auditability."
          </p>

          <!-- Defense 1: Threshold Issuance -->
          <div class="rounded-lg border border-navy-200 bg-white p-6 mb-6 shadow-sm">
            <h3 class="font-serif text-lg text-navy-900 font-semibold flex items-center gap-2 mb-3">
              <span class="inline-flex items-center justify-center w-7 h-7 rounded-full bg-gold-500 text-navy-900 text-sm font-bold">1</span>
              Threshold Credential Issuance
            </h3>

            <p class="text-navy-700 text-sm mb-3">
              Instead of a single registration authority, credentials require blind Schnorr signatures from
              <strong>t-of-n independent issuers</strong>. Each issuer runs an independent blind Schnorr
              ceremony &mdash; no single issuer sees the final credential, and no single issuer can forge one alone.
            </p>

            <div class="rounded-lg bg-navy-800 text-cream-100 p-4 font-mono text-xs leading-relaxed mb-4">
              <p class="text-gold-300 mb-2"># POC configuration: 2-of-3 independent issuers</p>
              <p>issuer_threshold: {"{"} t: 2, n: 3 {"}"}</p>
              <p class="mt-2 text-gold-300"># Each issuer independently signs via blind Schnorr:</p>
              <p>Issuer_1: blindSign(sk_1, voter_pk) &rarr; (R'_1, s'_1)</p>
              <p>Issuer_2: blindSign(sk_2, voter_pk) &rarr; (R'_2, s'_2)</p>
              <p>Issuer_3: blindSign(sk_3, voter_pk) &rarr; (R'_3, s'_3)</p>
              <p class="mt-2 text-gold-300"># Verification requires &ge;2 valid signatures:</p>
              <p>verify(pk_1, voter_pk, R'_1, s'_1) &amp;&amp;</p>
              <p>verify(pk_2, voter_pk, R'_2, s'_2) &rarr; VALID</p>
            </div>

            <p class="text-navy-700 text-sm">
              <strong>Why this works:</strong> A rogue issuer controlling one private key can produce one
              blind signature per ceremony, but cannot forge the other issuers' signatures. To mint a
              fraudulent credential, an attacker needs to compromise <em>t</em> independent authorities
              simultaneously &mdash; each operated by different organizations, in different jurisdictions,
              with independent key ceremonies.
            </p>
          </div>

          <!-- Defense 2: Voter Roll Commitment -->
          <div class="rounded-lg border border-navy-200 bg-white p-6 mb-6 shadow-sm">
            <h3 class="font-serif text-lg text-navy-900 font-semibold flex items-center gap-2 mb-3">
              <span class="inline-flex items-center justify-center w-7 h-7 rounded-full bg-gold-500 text-navy-900 text-sm font-bold">2</span>
              Voter Roll Commitment
            </h3>

            <p class="text-navy-700 text-sm mb-3">
              Before credential issuance begins, the election authority publishes a <strong>voter roll
              commitment</strong> in the election manifest: a Merkle root of all eligible voters and the
              total count. This is anchored on VoteChain before any credentials are issued.
            </p>

            <div class="rounded-lg bg-navy-800 text-cream-100 p-4 font-mono text-xs leading-relaxed mb-4">
              <p class="text-gold-300"># Published in the election manifest:</p>
              <p>voter_roll_commitment: {"{"}</p>
              <p class="ml-4">merkle_root: "SHA-256 root of eligible voter entries"</p>
              <p class="ml-4">total_eligible: 50000</p>
              <p>{"}"}</p>
              <p class="mt-2 text-gold-300"># Each credential issuance is logged on VCL:</p>
              <p>event: credential_issued {"{"}</p>
              <p class="ml-4">issuance_sequence: 1</p>
              <p class="ml-4">voter_roll_ceiling: 50000</p>
              <p>{"}"}</p>
              <p class="mt-2 text-gold-300"># Monitors verify: issuance_count &le; total_eligible</p>
            </div>

            <p class="text-navy-700 text-sm">
              <strong>Why this works:</strong> The VCL issuance counter is publicly visible. If it exceeds the
              voter roll commitment, monitors (academic institutions, NGOs, media) detect the anomaly immediately.
              The credential issuance event is privacy-preserving &mdash; it logs a sequence number, not voter
              identity &mdash; while still enabling public auditability of the <em>total count</em>.
            </p>
          </div>
        </section>

        <Divider withSeal={false} />

        <!-- Combined Defense -->
        <section class="mb-10 mt-8">
          <h2 class="font-serif text-xl text-navy-900 font-bold flex items-center gap-2 mb-4">
            <Icon name="check-circle" class="text-gold-600" />
            Combined Defense Properties
          </h2>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
            <div class="rounded-lg border border-green-200 bg-green-50 p-4">
              <p class="font-semibold text-green-800 text-sm mb-1">Collusion Resistance</p>
              <p class="text-green-700 text-xs">
                Forging a credential requires compromising t independent registration authorities
                simultaneously. Each operates under different governance, different jurisdictions,
                different key ceremonies.
              </p>
            </div>
            <div class="rounded-lg border border-green-200 bg-green-50 p-4">
              <p class="font-semibold text-green-800 text-sm mb-1">Public Ceiling</p>
              <p class="text-green-700 text-xs">
                The voter roll commitment is published before issuance begins. Any over-issuance
                is detectable by comparing VCL issuance events against the committed total.
              </p>
            </div>
            <div class="rounded-lg border border-green-200 bg-green-50 p-4">
              <p class="font-semibold text-green-800 text-sm mb-1">Privacy Preserved</p>
              <p class="text-green-700 text-xs">
                Blind Schnorr unlinkability is maintained. The VCL logs issuance sequence numbers,
                not voter identities. The Merkle root commits to the roll without exposing it.
              </p>
            </div>
            <div class="rounded-lg border border-green-200 bg-green-50 p-4">
              <p class="font-semibold text-green-800 text-sm mb-1">Independent Verification</p>
              <p class="text-green-700 text-xs">
                The Trust Portal verifies: (1) credential signatures meet threshold, (2) issuance
                count &le; voter roll ceiling, (3) VCL issuance events match the counter.
              </p>
            </div>
          </div>

          <h3 class="font-serif text-lg text-navy-900 font-semibold mt-6 mb-3">Residual risks</h3>

          <ul class="text-navy-700 text-sm list-disc ml-5 space-y-2 mb-4">
            <li>
              <strong>Threshold collusion:</strong> If t issuers collude, they can forge credentials.
              Mitigation: select issuers from independent organizations (e.g., bipartisan board members,
              different government agencies, independent auditors).
            </li>
            <li>
              <strong>Voter roll inflation:</strong> If the voter roll commitment itself is fraudulently
              inflated (e.g., registering phantom voters), the ceiling is too high. Mitigation: voter roll
              is independently auditable and published before issuance begins.
            </li>
            <li>
              <strong>Post-hoc detection only for ceiling breach:</strong> The voter roll commitment
              prevents <em>undetectable</em> over-issuance, but detection is post-hoc. Threshold issuance
              provides the <em>preventive</em> layer.
            </li>
          </ul>
        </section>

        <Divider withSeal={false} />

        <!-- Verification -->
        <section class="mt-8">
          <h2 class="font-serif text-xl text-navy-900 font-bold flex items-center gap-2 mb-4">
            <Icon name="search" class="text-gold-600" />
            Verify It Yourself
          </h2>

          <p class="text-navy-700 text-sm mb-4">
            The POC Trust Portal includes a live credential issuance integrity check. After registering
            a credential in the voting client, visit the Trust Portal to verify:
          </p>

          <ul class="text-navy-700 text-sm list-disc ml-5 space-y-1.5 mb-6">
            <li>All 3 independent issuer public keys are published in the manifest</li>
            <li>Your credential carries blind Schnorr signatures from all 3 issuers</li>
            <li>The VCL records a <code>credential_issued</code> event with the correct sequence number</li>
            <li>Total issuance count does not exceed the voter roll commitment ceiling</li>
          </ul>

          <div class="flex flex-wrap gap-3">
            <a
              href="/votechain/poc/trust"
              class="inline-flex items-center gap-2 rounded-md bg-navy-800 px-5 py-2.5 text-gold-200 font-sans text-sm font-semibold hover:bg-navy-700 transition-colors"
            >
              <Icon name="shield" class="text-gold-300" size={18} />
              Trust Portal
            </a>
            <a
              href="/votechain/poc/vote"
              class="inline-flex items-center gap-2 rounded-md border border-navy-200 bg-white px-5 py-2.5 text-navy-800 font-sans text-sm font-semibold hover:border-gold-500 hover:shadow-sm transition-all"
            >
              <Icon name="vote" class="text-navy-700" size={18} />
              Voting Client
            </a>
          </div>
        </section>

      </div>
    </div>
  </div>
</BaseLayout>
