---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Icon from '../../components/ui/Icon.astro';
import MermaidClient from '../../components/votechain/MermaidClient.astro';
---

<BaseLayout
  title="VoteChain Raspberry Pi Integration Guide"
  description="How to integrate polling-place vote machines into the VoteChain air-gapped test architecture using Raspberry Pi hardware, with wiring diagrams and test-cycle controls."
  ogType="article"
  article={{
    publishedTime: '2026-02-12',
    modifiedTime: '2026-02-12',
    author: 'Absurdity Index',
    section: 'Engineering',
    tags: ['votechain', 'raspberry pi', 'polling place', 'air gap', 'integration'],
  }}
>
  <div class="max-w-4xl mx-auto px-4 py-8">
    <div class="text-center mb-6">
      <p class="text-xs text-gold-600 font-mono uppercase tracking-widest mb-1">
        Integration Blueprint
      </p>
      <h1 class="font-serif text-2xl md:text-3xl text-navy-900 font-bold">
        Vote Machine Integration On Raspberry Pi Test Benches
      </h1>
      <p class="text-navy-600 font-serif italic mt-2 text-sm max-w-2xl mx-auto">
        Practical lab wiring model for public working-group elections: booth hardware, trust boundaries,
        and run-cycle controls.
      </p>
    </div>

    <div class="rounded-lg border border-gold-300 bg-cream-50 p-5 mb-8">
      <div class="flex items-start gap-3">
        <Icon name="alert-triangle" class="text-gold-700 mt-0.5 flex-shrink-0" />
        <div class="text-navy-800 text-sm space-y-2">
          <p>
            This is a test-election integration profile, not a certified election deployment profile.
          </p>
          <p>
            Visual source:
            <a
              href="/votechain/evidence/pi-integration-board"
              class="underline decoration-gold-500 underline-offset-2 hover:text-gold-700"
            >
              /votechain/evidence/pi-integration-board
            </a>
            (Mermaid source is embedded directly on this page).
          </p>
        </div>
      </div>
    </div>

    <article class="bg-parchment rounded-lg shadow-lg p-6 md:p-8 text-navy-900">
      <h2 id="integration-flow" class="font-serif text-2xl font-bold mb-3">How To Integrate The Vote Machine</h2>
      <ol class="list-decimal pl-6 space-y-2 mb-6">
        <li>Provision each booth Pi with the same signed machine runtime image and pinned runtime config.</li>
        <li>Attach fixed booth peripherals: touch display, scanner, receipt printer, UPS, tamper inputs.</li>
        <li>Connect booth Pis to isolated polling-place switch on VLAN10 (`10.10.10.0/24`) with no internet route.</li>
        <li>Export signed session bundles to transfer station and ingest one-way into VLAN20 airgap services.</li>
        <li>Mirror accepted bundles into VLAN30 central verification services for independent reconciliation.</li>
        <li>Enforce session close and machine-local reset after every voter interaction.</li>
      </ol>

      <h2 id="topology-diagrams" class="font-serif text-2xl font-bold mb-3">Pi Topology Diagrams</h2>
      <figure class="mb-6">
        <pre data-language="mermaid">{`%% diagram-id: pi-lab-topology
flowchart LR
  classDef hw fill:#e8d5b0,stroke:#a88b4a,stroke-width:1.5px
  classDef net fill:#dce7f5,stroke:#3a6fa0,stroke-width:1.5px
  classDef db fill:#f0ebe0,stroke:#8a6e36,stroke-width:1.5px
  classDef sec fill:#d9eee2,stroke:#2d8a5e,stroke-width:1.5px
  subgraph POLL["Boundary: Polling Place Zone (VLAN10)"]
    direction TB
    PMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Polling Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>VLAN10 polling LAN · Ports 22, 443, 9100</span>"]:::net
    B1["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi 1</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 vote terminal · Ports 443, 9100</span>"]:::hw
    B2["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi 2</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 vote terminal · Ports 443, 9100</span>"]:::hw
    B3["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi 3</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 vote terminal · Ports 443, 9100</span>"]:::hw
    B4["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi 4</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 vote terminal · Ports 443, 9100</span>"]:::hw
    B5["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi 5</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 vote terminal · Ports 443, 9100</span>"]:::hw
    OPS["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Ops Pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Poll worker operations Pi · Ports 443, 1514</span>"]:::hw
    PSW["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Polling Switch</b><br/><span style='font-size:0.8em;opacity:0.65'>Layer-2 booth uplink switch · Forwards signed bundles</span>"]:::net
    B1 --> PSW
    B2 --> PSW
    B3 --> PSW
    B4 --> PSW
    B5 --> PSW
    OPS --> PSW
  end

  subgraph XFER["Boundary: Controlled Transfer Gate"]
    direction TB
    XMETA["<img src='/votechain/evidence/icons/transfer.svg' width='24' height='24'/><b>Transfer Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>One-way media validation enclave · Port 443 ingress</span>"]:::net
    EK["<img src='/votechain/evidence/icons/transfer.svg' width='24' height='24'/><b>Export Kiosk Pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Outbound transfer Pi · Receives bundles on 443</span>"]:::net
    SCAN["<img src='/votechain/evidence/icons/scan.svg' width='24' height='24'/><b>Import Scan Pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Hash and malware validation Pi · Forwards to ingest on 443</span>"]:::net
    EK --> SCAN
  end

  subgraph AIR["Boundary: Airgap Core (VLAN20)"]
    direction TB
    AMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Airgap Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Isolated VLAN20 segment · Ports 443, 1514</span>"]:::net
    ING["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Airgap Ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Ingress Pi service · Validates and writes events on 443</span>"]:::hw
    REL["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Airgap Relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Airgap transport Pi · Relays to ledger replicas on 443</span>"]:::hw
    OBS["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Observer Pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Monitoring Pi · Watches role drift and ACK anomalies on 1514</span>"]:::sec
    AL["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>Airgap Ledger Cluster</b><br/><span style='font-size:0.8em;opacity:0.65'>Replicas a1-a3 on Pi hosts · Append-only records on 443</span>"]:::db
    ING --> AL
    REL --> AL
    OBS --> AL
  end

  subgraph CENT["Boundary: Central Verify (VLAN30)"]
    direction TB
    CMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Central Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Verification VLAN30 segment · Ports 443, 1514</span>"]:::net
    CING["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>Central Ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Central intake host · Receives airgap mirror on 443</span>"]:::net
    CREL["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>Central Relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Central forwarding host · Routes to central ledger on 443</span>"]:::net
    CMON["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Oversight Monitor</b><br/><span style='font-size:0.8em;opacity:0.65'>Independent monitor host · Verification alerts on 1514</span>"]:::sec
    CL["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>Central Ledger Cluster</b><br/><span style='font-size:0.8em;opacity:0.65'>Central replica set · Verification mirror and audit proof on 443</span>"]:::db
    CING --> CL
    CREL --> CL
    CMON --> CL
  end

  PSW -->|HTTPS 443 signed bundle export| EK
  SCAN -->|HTTPS 443 one-way ingest| ING
  AL -.->|HTTPS 443 mirror for central verification| CING
`}</pre>
        <figcaption class="text-xs text-navy-600 mt-2">
          End-to-end topology from polling boundary through central verification.
        </figcaption>
      </figure>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <figure>
          <pre data-language="mermaid">{`%% diagram-id: pi-machine-wiring
flowchart LR
  classDef hw fill:#e8d5b0,stroke:#a88b4a,stroke-width:1.5px
  classDef net fill:#dce7f5,stroke:#3a6fa0,stroke-width:1.5px
  classDef db fill:#f0ebe0,stroke:#8a6e36,stroke-width:1.5px
  classDef sec fill:#d9eee2,stroke:#2d8a5e,stroke-width:1.5px
  subgraph PERI["Boundary: Booth Peripheral Harness"]
    direction TB
    PMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Peripheral Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Locally cabled device harness · HDMI, USB, GPIO, Ethernet</span>"]:::net
    TD["<img src='/votechain/evidence/icons/device-desktop.svg' width='24' height='24'/><b>Touch Display</b><br/><span style='font-size:0.8em;opacity:0.65'>Voter interaction display · Ballot UI over HDMI</span>"]:::net
    QR["<img src='/votechain/evidence/icons/qrcode.svg' width='24' height='24'/><b>QR Scanner</b><br/><span style='font-size:0.8em;opacity:0.65'>Optical scanner peripheral · Reads QR over USB</span>"]:::net
    PR["<img src='/votechain/evidence/icons/printer.svg' width='24' height='24'/><b>Receipt Printer</b><br/><span style='font-size:0.8em;opacity:0.65'>Thermal print peripheral · Receipts over USB</span>"]:::net
    KEY["<img src='/votechain/evidence/icons/key.svg' width='24' height='24'/><b>Poll Worker Key</b><br/><span style='font-size:0.8em;opacity:0.65'>Admin credential token reader · Unlocks ops over USB</span>"]:::sec
    UPS["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>UPS HAT</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi power continuity module · Battery and brownout over I2C</span>"]:::sec
    TMP["<img src='/votechain/evidence/icons/shield-x.svg' width='24' height='24'/><b>Tamper Switch</b><br/><span style='font-size:0.8em;opacity:0.65'>Chassis intrusion sensor · Tamper alert over GPIO17</span>"]:::sec
    LAN["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Booth LAN Switch</b><br/><span style='font-size:0.8em;opacity:0.65'>Local Ethernet access switch · Uplink on RJ45</span>"]:::net
    SEAL["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Security Seal Sensor</b><br/><span style='font-size:0.8em;opacity:0.65'>Enclosure seal monitor · Seal state over GPIO27</span>"]:::sec
  end

  subgraph HOST["Boundary: Booth Controller Runtime"]
    direction TB
    HMETA["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Host Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>booth-pi-01 Pi 5 runtime · Ports 443, 9100, SSH 22</span>"]:::hw
    PI["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi Controller</b><br/><span style='font-size:0.8em;opacity:0.65'>Primary voting control Pi 5 · Session signing and print handoff</span>"]:::hw
  end

  TD -->|HDMI0| PI
  QR -->|USB-A| PI
  PR -->|USB-A| PI
  KEY -->|USB-A| PI
  UPS -->|I2C| PI
  TMP -->|GPIO17| PI
  LAN -->|eth0 RJ45| PI
  SEAL -->|GPIO27| PI
`}</pre>
          <figcaption class="text-xs text-navy-600 mt-2">
            Booth Pi peripheral harness.
          </figcaption>
        </figure>

        <figure>
          <pre data-language="mermaid">{`%% diagram-id: pi-network-segmentation
flowchart LR
  classDef hw fill:#e8d5b0,stroke:#a88b4a,stroke-width:1.5px
  classDef net fill:#dce7f5,stroke:#3a6fa0,stroke-width:1.5px
  classDef db fill:#f0ebe0,stroke:#8a6e36,stroke-width:1.5px
  classDef sec fill:#d9eee2,stroke:#2d8a5e,stroke-width:1.5px
  subgraph V10["Boundary: VLAN10 Polling Segment"]
    direction TB
    V10META["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>VLAN10 Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Polling-place booth network · Ports 22, 443, 9100, 1514</span>"]:::net
    BP["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth + Ops Cluster</b><br/><span style='font-size:0.8em;opacity:0.65'>Six Pi hosts on VLAN10 · Signed bundles and health events</span>"]:::hw
    PSW["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Polling Switch</b><br/><span style='font-size:0.8em;opacity:0.65'>VLAN10 switch fabric · Local forwarding and uplink policy</span>"]:::net
    BP --> PSW
  end

  subgraph XFER["Boundary: Transfer Gate Segment"]
    direction TB
    XMETA["<img src='/votechain/evidence/icons/transfer.svg' width='24' height='24'/><b>Transfer Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Quarantine handoff enclave · One-way ingest on 443</span>"]:::net
    EK["<img src='/votechain/evidence/icons/transfer.svg' width='24' height='24'/><b>Export Kiosk</b><br/><span style='font-size:0.8em;opacity:0.65'>Outbound transfer service · Receives bundles from polling switch</span>"]:::net
    SCAN["<img src='/votechain/evidence/icons/scan.svg' width='24' height='24'/><b>Import Scan</b><br/><span style='font-size:0.8em;opacity:0.65'>Inbound validation service · Hashes and forwards clean bundles</span>"]:::net
    EK --> SCAN
  end

  subgraph V20["Boundary: VLAN20 Airgap Segment"]
    direction TB
    V20META["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>VLAN20 Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Isolated airgap subnet · Ports 443, 1514</span>"]:::net
    ING["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Airgap Ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Intake Pi service · Validates signatures and writes entries</span>"]:::hw
    REL["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Airgap Relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Transfer Pi service · Routes approved events to replicas</span>"]:::hw
    OBS["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Observer Pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Watchdog Pi service · Monitors ACK keys and role health</span>"]:::sec
    AL["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>Airgap Ledger</b><br/><span style='font-size:0.8em;opacity:0.65'>Append-only replica set · Signed election events on 443</span>"]:::db
    ING --> AL
    REL --> AL
    OBS --> AL
  end

  subgraph V30["Boundary: VLAN30 Central Segment"]
    direction TB
    V30META["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>VLAN30 Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Independent central verify subnet · Ports 443, 1514</span>"]:::net
    CING["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>Central Ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Central intake host · Pulls mirrored records on 443</span>"]:::net
    CREL["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>Central Relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Central routing host · Forwards mirrored stream to ledger</span>"]:::net
    CMON["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Oversight Monitor</b><br/><span style='font-size:0.8em;opacity:0.65'>Audit host service · Alerts from mirrored logs on 1514</span>"]:::sec
    CL["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>Central Ledger</b><br/><span style='font-size:0.8em;opacity:0.65'>Central replica set · Verification mirror on 443</span>"]:::db
    CING --> CL
    CREL --> CL
    CMON --> CL
  end

  PSW -->|HTTPS 443 signed bundle| EK
  SCAN -->|HTTPS 443 one-way ingest| ING
  AL -.->|HTTPS 443 mirror channel| CING
`}</pre>
          <figcaption class="text-xs text-navy-600 mt-2">
            VLAN boundaries and control-plane flow enforcement.
          </figcaption>
        </figure>
      </div>

      <h2 id="physical-wiring" class="font-serif text-2xl font-bold mb-3">Physical Wiring Details</h2>
      <ul class="list-disc pl-6 space-y-2 mb-6">
        <li>Booth Pi host: Raspberry Pi 5 (8GB), immutable image, sealed enclosure.</li>
        <li>Peripherals: HDMI touch, USB scanner, USB receipt printer, poll-worker key, UPS HAT.</li>
        <li>Tamper channels: GPIO tamper switch + enclosure-open signal to sealed logs.</li>
        <li>Network: wired Ethernet only for booth machines; no Wi-Fi association in test profile.</li>
      </ul>

      <h2 id="compose-placement" class="font-serif text-2xl font-bold mb-3">Compose Placement</h2>
      <figure class="mb-4">
        <pre data-language="mermaid">{`%% diagram-id: pi-compose-placement
flowchart LR
  classDef hw fill:#e8d5b0,stroke:#a88b4a,stroke-width:1.5px
  classDef net fill:#dce7f5,stroke:#3a6fa0,stroke-width:1.5px
  classDef db fill:#f0ebe0,stroke:#8a6e36,stroke-width:1.5px
  classDef sec fill:#d9eee2,stroke:#2d8a5e,stroke-width:1.5px
  subgraph POLL["Boundary: Polling Runtime Placement"]
    direction TB
    PMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Polling Runtime Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Booth subnet container placement · Ports 443, 9100, 1514</span>"]:::net
    P1["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>booth-pi-[1..5]</b><br/><span style='font-size:0.8em;opacity:0.65'>Voting host group on Pi 5 · machine-api and session-store on 443, 9100</span>"]:::hw
    P2["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>ops-pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Polling operations host · Health and log shipper on 443, 1514</span>"]:::hw
  end

  subgraph AIR["Boundary: Airgap Runtime Placement"]
    direction TB
    AMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Airgap Runtime Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>VLAN20 isolated deployment zone · Ports 443, 1514</span>"]:::net
    A1["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>airgap-ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Ingest service host · Verifies boundary payloads on 443</span>"]:::hw
    A2["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>airgap-relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Relay service host · Routes approved records to ledger on 443</span>"]:::hw
    A3["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>airgap-ledger-a1-a2-a3</b><br/><span style='font-size:0.8em;opacity:0.65'>Ledger replica service group · Append-only records on 443</span>"]:::db
    A4["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>observer-pi</b><br/><span style='font-size:0.8em;opacity:0.65'>Monitoring service host · Role and ACK integrity on 1514</span>"]:::sec
  end

  subgraph CENT["Boundary: Central Runtime Placement"]
    direction TB
    CMETA["<img src='/votechain/evidence/icons/router.svg' width='24' height='24'/><b>Central Runtime Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>VLAN30 verification deployment zone · Ports 443, 1514</span>"]:::net
    C1["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>central-ingest</b><br/><span style='font-size:0.8em;opacity:0.65'>Mirror intake host · Receives mirrored airgap stream on 443</span>"]:::net
    C2["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>central-relay</b><br/><span style='font-size:0.8em;opacity:0.65'>Central routing host · Forwards mirrored stream to ledger on 443</span>"]:::net
    C3["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>central-ledger-1-2-3</b><br/><span style='font-size:0.8em;opacity:0.65'>Central ledger replica set · Persists mirrored records on 443</span>"]:::db
    C4["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>audit-verifier</b><br/><span style='font-size:0.8em;opacity:0.65'>Independent audit host · Chain integrity and alerts on 1514</span>"]:::sec
  end
  P1 -->|HTTPS 443 signed bundle| A1
  A1 -->|HTTPS 443 validated records| A2
  A2 -->|HTTPS 443 append events| A3
  A4 -->|log stream 1514| A3
  A3 -.->|HTTPS 443 mirror| C1
  C1 -->|HTTPS 443 route| C2
  C2 -->|HTTPS 443 write| C3
  C4 -->|integrity checks 1514| C3
`}</pre>
        <figcaption class="text-xs text-navy-600 mt-2">
          Container service placement per execution profile zone.
        </figcaption>
      </figure>
      <pre class="bg-cream-100 border border-navy-200 rounded-md p-3 text-xs overflow-x-auto mb-6"><code># Start stack (example test profile)
docker compose down -v --remove-orphans
docker compose up -d --build

# Execute run loop
./scripts/run-mock-election-cycle.py --machines 5 --sessions-per-machine 100 --spoil-rate 0.12 --seed 20260212</code></pre>

      <h2 id="session-loop" class="font-serif text-2xl font-bold mb-3">Session Loop</h2>
      <figure class="mb-6">
        <pre data-language="mermaid">{`%% diagram-id: pi-test-cycle
flowchart LR
  classDef hw fill:#e8d5b0,stroke:#a88b4a,stroke-width:1.5px
  classDef net fill:#dce7f5,stroke:#3a6fa0,stroke-width:1.5px
  classDef db fill:#f0ebe0,stroke:#8a6e36,stroke-width:1.5px
  classDef sec fill:#d9eee2,stroke:#2d8a5e,stroke-width:1.5px
  subgraph CLIENT["Boundary: Voter Session"]
    direction TB
    VMETA["<img src='/votechain/evidence/icons/device-desktop.svg' width='24' height='24'/><b>Session Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Supervised voter interaction boundary · No direct network ports</span>"]:::net
    V["<img src='/votechain/evidence/icons/device-desktop.svg' width='24' height='24'/><b>Voter Session</b><br/><span style='font-size:0.8em;opacity:0.65'>In-booth voter interaction · Credential, cast, or challenge</span>"]:::net
  end

  subgraph BOOTH["Boundary: Booth Runtime"]
    direction TB
    BMETA["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Pi 5 voting runtime · Voting app and reset on 443, 9100</span>"]:::hw
    B["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Booth Pi Service</b><br/><span style='font-size:0.8em;opacity:0.65'>Booth controller service · Session signing and secure reset on 443, 9100</span>"]:::hw
  end

  subgraph XFER["Boundary: Transfer Runtime"]
    direction TB
    TMETA["<img src='/votechain/evidence/icons/transfer.svg' width='24' height='24'/><b>Transfer Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Export and scan gateway pair · One-way movement on 443</span>"]:::net
    T["<img src='/votechain/evidence/icons/scan.svg' width='24' height='24'/><b>Transfer Validation Service</b><br/><span style='font-size:0.8em;opacity:0.65'>Hash and malware gate · Admits signed clean bundles on 443</span>"]:::net
  end

  subgraph AIR["Boundary: Airgap Runtime"]
    direction TB
    AMETA["<img src='/votechain/evidence/icons/raspberry-pi.svg' width='24' height='24'/><b>Airgap Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Isolated ingest service runtime · Validates and writes on 443</span>"]:::hw
    A["<img src='/votechain/evidence/icons/database.svg' width='24' height='24'/><b>Airgap Ingest Ledger</b><br/><span style='font-size:0.8em;opacity:0.65'>Ingest plus ledger write path · Persists events and emits mirror</span>"]:::db
  end

  subgraph CENT["Boundary: Central Verify Runtime"]
    direction TB
    CMETA["<img src='/votechain/evidence/icons/server.svg' width='24' height='24'/><b>Central Boundary</b><br/><span style='font-size:0.8em;opacity:0.65'>Independent verify host runtime · Reconciliation on 443, 1514</span>"]:::net
    C["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Central Verify Service</b><br/><span style='font-size:0.8em;opacity:0.65'>Central audit response · Mirror integrity ok or fail on 443</span>"]:::sec
  end

  V -->|1 present credential| B
  V -->|2 cast or challenge and receipt| B
  B -->|3 export signed bundle HTTPS 443| T
  T -->|4 one-way ingest HTTPS 443| A
  A -.->|5 mirror for reconcile HTTPS 443| C
  C -->|6 audit response HTTPS 443| B
  B -->|7 session close and secure reset| V

  H1["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Harness Controller</b><br/><span style='font-size:0.8em;opacity:0.65'>Mock election runner · 5x100 sessions, residual cache zero</span>"]:::sec
  H2["<img src='/votechain/evidence/icons/shield-check.svg' width='24' height='24'/><b>Integrity Monitor</b><br/><span style='font-size:0.8em;opacity:0.65'>Post-run verification · Detects duplicate vote, rogue ACK, unauthorized role</span>"]:::sec
  H1 -.-> B
  H2 -.-> C
`}</pre>
        <figcaption class="text-xs text-navy-600 mt-2">
          Per-voter session and reset sequence, end-to-end.
        </figcaption>
      </figure>

      <h2 id="verification-gates" class="font-serif text-2xl font-bold mb-3">Verification Gates To Keep</h2>
      <ul class="list-disc pl-6 space-y-2 mb-6">
        <li>Machine reset proof after every session with zero residual ballot/credential state.</li>
        <li>Bundle signature and schema validation at ingest before any ledger write.</li>
        <li>Relay ACK-key pinning with immediate degradation alert on mismatch.</li>
        <li>Outbox must drain to zero before run completion.</li>
        <li>Airgap and central run summaries must match cast/receipt totals.</li>
      </ul>

      <h2 id="tech-doc-links" class="font-serif text-2xl font-bold mb-3">Tech Docs + Assets</h2>
      <ul class="list-disc pl-6 space-y-2">
        <li>
          Pi diagram board source:
          <a href="/votechain/evidence/pi-integration-board" class="underline decoration-gold-500 underline-offset-2 hover:text-gold-700">
            /votechain/evidence/pi-integration-board
          </a>
        </li>
        <li>
          Technical appendix:
          <a href="/votechain/field-report-technical" class="underline decoration-gold-500 underline-offset-2 hover:text-gold-700">
            /votechain/field-report-technical
          </a>
        </li>
      </ul>
    </article>
  </div>
  <MermaidClient />
</BaseLayout>
