{
  "version": 1,
  "generated_at": "2026-02-14T00:00:00.000Z",
  "bundles": [
    {
      "bundle_id": "valid_castable",
      "short_code": "VC-001",
      "status": "ready",
      "receipt_kind": "expected",
      "nullifier": "0x95f4acb239f1c6f0f2c4a5b7b1cf6d8fd15a64ab7c37c3a9d0fdf4614fb3aab0",
      "credential": {
        "did": "did:key:z6Mkj1q1zGa3gNEktzB5i7yXSqWxdDDy7cXDs2rfVwX47GNa",
        "curve": "secp256k1",
        "pk": "A8QrF2XHTk1xYV3f8RtygAj6n3aJ5Ym2vN4YQbC1Vn8E",
        "sk": "zFJ5UMpE5l4KJTZ9CqVrZ8R0xYrZcU4FJox0GmA6LzE",
        "blind_sigs": [
          {
            "issuer_index": 0,
            "R": "AtZy5ryUNs8N2yRk5eDkW0W5KZpVz2n5Xx1G3h2B9lQ",
            "s": "Ngnb5v6gGgIuQeYxXwqChWZ2sJQLvE1m1i5Gx1dGU-U"
          },
          {
            "issuer_index": 1,
            "R": "AqYb4lCfi6Sh1Uz8Hs5M07KpL9YAb9QZ0Cw2kM-Gu7A",
            "s": "VwV4k3h2a8Kq6Pl5W2h5R9n0u4d6F8p7SzQ2cDnQW6Y"
          },
          {
            "issuer_index": 2,
            "R": "A1mVw2Zx5Qn8Rs4Tj7Uk9Yl2Po5Se8Dc1Fg3Hi6Jk0Q",
            "s": "Xz8Qw7Er6Ty5Ui4Op3As2Df1Gh0Jk9Lh8Mn7Bv6Cx4Z"
          }
        ],
        "created_at": "2026-02-11T17:12:45.000Z"
      },
      "receipt": {
        "receipt_id": "fixture-receipt-valid-cast",
        "election_id": "poc-2026-local-walkthrough",
        "manifest_id": "poc-2026-local-manifest",
        "ballot_hash": "0x7c2b91332098e915c2fc0ce5ec76e0b27f5c3a9fc8dc2621e4158ba51c7bc182",
        "bb_leaf_hash": "0xbef4e1a48541b754b8cdd16c54bfb8d3bc986aaef6c0f80918237e36a7c08d0c",
        "bb_sth": {
          "tree_size": 42,
          "root_hash": "0xaf4c4a4feee4bdc3c7a64b784b339a9d46a02dd68d1718ff1ac58b1f11516f1b",
          "timestamp": "2026-02-11T17:12:50.000Z",
          "kid": "bb-dev-001",
          "sig": "MEQCICW0zZ1nR4x1CeJ0iC0eO87jgOKzwB0LMtOZ4DjFd3ryAiA1f6l1eZ5Zk4NPGaYmN6cGX5GR5HlidNdSz6lpujQgwQ=="
        },
        "votechain_anchor": {
          "tx_id": "0x3b7a0c5fb2e454f4b1dbf0a8562f1c72405463e99aa7d2fd8ad1b3c9cf7954b1",
          "event_type": "ewp_ballot_cast",
          "sth_root_hash": "0xaf4c4a4feee4bdc3c7a64b784b339a9d46a02dd68d1718ff1ac58b1f11516f1b"
        },
        "ledger_acks": [
          {
            "node_role": "state",
            "entry_index": 120,
            "entry_hash": "0x1ca1d2e3f4b5c6d7e8f90123456789abcdeffedcba987654321001122334455",
            "ack": {
              "alg": "ES256",
              "kid": "state-node-ny",
              "sig": "MEYCIQC1Q5G97ytOcErDoFXGsP1IbF1CS3eDiS6k9Wl3qhTQ1QIhAP5lno2D3Wk7mDe3Mew5wWZuC7Uwswi64xLHjF8ZQnIi"
            }
          },
          {
            "node_role": "federal",
            "entry_index": 215,
            "entry_hash": "0x76bb2fb3c8a40cf7e4f6210738dddd6cc80b3983112233445566778899aabbcc",
            "ack": {
              "alg": "ES256",
              "kid": "federal-node-1",
              "sig": "MEUCIQCvty7hCw6uJTrQx1tw93RpuDZvjLdM78412-exZv1ZWgIgOQzTDBbC8v6V4nJXnZ7XBmF4u4sXQ7hg1jHNRO8xFWo="
            }
          }
        ],
        "kid": "ewp-gateway-1",
        "sig": "MEUCIQC9e2W9i5p1AiC5K2jM5Dz7Uv6VnS3Pkukns9ZkT1Tl9QIge2uYDceeEoeiUv0uFHu4i1w6glpXjS8HK3mJSeOJQFU="
      },
      "metadata": {
        "title": "Pristine credential can cast exactly once",
        "summary": "Happy-path enrollment used for the Playwright walkthrough. Nullifier has never been seen in VoteChain logs and should flip to consumed right after cast.",
        "fr_refs": ["FR-1"],
        "tags": ["happy_path", "cast"],
        "notes": [
          "Issue credential, run through the wizard once, expect cast_recorded.",
          "After consumption the worker should store consumed_at and return STATE_OK."
        ],
        "expectation": "Worker seeds this credential as READY; after cast, status becomes CONSUMED with the above receipt."
      },
      "audit": {
        "created_by": "scripts/playwright-setup-walkthrough.mjs",
        "reason": "Baseline Playwright walkthrough bundle",
        "last_verified_at": "2026-02-13T23:18:20.000Z"
      }
    },
    {
      "bundle_id": "used_duplicate",
      "short_code": "VC-002",
      "status": "consumed",
      "receipt_kind": "recorded",
      "nullifier": "0xa4e2bd9c7fb2d1e04a6b95b127d8cdf395b9a1b90c1fddc4e6a4dcb9c6f11234",
      "credential": {
        "did": "did:key:z6MkqJrD8WKjpk7AyLWwXw47L8bhyXvXk3jKtPPEJp1q5QqR",
        "curve": "secp256k1",
        "pk": "A7gq2BAs4Uqz9WmkEu3fQ6y8sMv1L0d9NgS3JcY5Hk1P",
        "sk": "uF4La2Nl5xVg3Jz2P1k0Hs8Qm9Nv5Qw2Lc7Yp0Hg2wA",
        "blind_sigs": [
          {
            "issuer_index": 0,
            "R": "An82w5Qx7Er4Tu5Yi3Ol8Pn2Ms7Qa9Wb1Fe3Gh5Jk8M",
            "s": "Qv6Yt5Re4Wq3Es2Dr1Ft0Gy9Hu8Ji7Ko6Lp5Ns4Md3P"
          },
          {
            "issuer_index": 2,
            "R": "Av1Lp3Bh5Nd7Qf9Rg2Sk4Vm6Xp8Zo1By3Ct5Ev7Gw9J",
            "s": "Xu1Yv2Wx3Zu4Ap5Bq6Cr7Ds8Et9Fu0Gv1Hw2Ix3Jy4K"
          },
          {
            "issuer_index": 3,
            "R": "Ak4Ms6Pf8Rg1Th3Vj5Xl7Zn9Bo2Cp4Dq6Fr8Hs0Ju2L",
            "s": "Zx3Cv4Bn5Nm6Mq7Wp8Or9Pt0Yu1Ii2Oo3Po4Lp5Ku6J"
          }
        ],
        "created_at": "2026-02-10T09:04:11.000Z"
      },
      "receipt": {
        "receipt_id": "fixture-receipt-duplicate-original",
        "election_id": "poc-2026-local-walkthrough",
        "manifest_id": "poc-2026-local-manifest",
        "ballot_hash": "0x9026ab1cc5b8702b274b528b72b4f3e7d6c3b5a9fcaf4de192837aeb858acdd1",
        "bb_leaf_hash": "0x6cf4b2c3e5d6f708192a3b4c5d6e7f8091a2b3c4d5e6f708192a3b4c5d6e7f80",
        "bb_sth": {
          "tree_size": 57,
          "root_hash": "0xfec0d1e2f3a4b5c6d7e8f9012233445566778899aabbccddeeff001122334455",
          "timestamp": "2026-02-12T05:45:18.000Z",
          "kid": "bb-dev-001",
          "sig": "MEYCIQCzDbusfVfLwN1pnpLDSVv1sXLTiHUks3quIX1hvPFd8wIhAMEdrJ2O5D1Ya7eyQSJBV8xkSzWcBoBPXaG9q4CPGK1a"
        },
        "votechain_anchor": {
          "tx_id": "0x4e39d843dfd29bafc52e071942f91bde8d5b2a1dfc5b8e6930f4bfc02028e9a1",
          "event_type": "ewp_ballot_cast",
          "sth_root_hash": "0xfec0d1e2f3a4b5c6d7e8f9012233445566778899aabbccddeeff001122334455"
        },
        "ledger_acks": [
          {
            "node_role": "state",
            "entry_index": 201,
            "entry_hash": "0xaabbccddeeff00112233445566778899aabbccddeeff00112233445566778899",
            "ack": {
              "alg": "ES256",
              "kid": "state-node-ny",
              "sig": "MEUCIQCR6b7cD8uJ9k4lP3s2q1r0t9u8w7v6x5y4z3y2x1wOtgAIgSKP8nU2dH5jL2nP1qM0o9n8m7l6k5j4h3g2f1e0d9c8b7"
            }
          }
        ],
        "kid": "ewp-gateway-1",
        "sig": "MEUCIQD4jN3vP6zM2wS9gU1gL0jD4hM7kO2pT5vY6rX7sYz0RAIgU1a2b3c4d5e6f7g8h9i0jA1b2c3d4e5f6g7h8i9j0k="
      },
      "metadata": {
        "title": "Duplicate attempt should be blocked",
        "summary": "First cast already anchored; any replay should trip FR-1 duplicate detection with immediate STATE_DIRTY if the DB diverges.",
        "fr_refs": ["FR-1"],
        "tags": ["duplicate", "consumed"],
        "notes": [
          "Nullifier already appears on ledger with receipt fixture-receipt-duplicate-original.",
          "Subsequent casts must be rejected and flagged as fraud_flag duplicate_nullifier."
        ],
        "expectation": "Worker keeps this credential in CONSUMED forever and refuses to issue new challenges for it."
      },
      "audit": {
        "created_by": "scripts/playwright-setup-walkthrough.mjs",
        "reason": "Regression vector for duplicate FR-1 enforcement",
        "last_verified_at": "2026-02-13T23:19:02.000Z"
      },
      "consumed_at": "2026-02-12T05:45:20.000Z"
    },
    {
      "bundle_id": "invalid_signature",
      "short_code": "VC-003",
      "status": "invalid",
      "receipt_kind": "rejected",
      "nullifier": "0xe6027db214feedc45ab403f2deb86a5f1d78a3fd18fb12e50978c0430f3d44e1",
      "credential": {
        "did": "did:key:z6MkrK9fEqj1Qy9z2pQ5r7u1VxWd8yZk3oL4n5p6Rq7stuAz",
        "curve": "secp256k1",
        "pk": "A6p9Ewq1Tr4Uy7Io0Pa3Sd6Fh9Jk2Lm5No8Pq1Rs4Tu7",
        "sk": "wQ3Er6Ti9Yo2Up5Nq8Rs1Vv4Yx7Bz0Dg3Fk6Hm9Jp2S",
        "blind_sigs": [
          {
            "issuer_index": 1,
            "R": "Ah2Jk4Lm6No8Pq0Rs2Tu4Vw6Xy8Za0Bc2De4Fg6Hi8J",
            "s": "Uu2Vv3Ww4Xx5Yy6Zz7Aa8Bb9Cc0Dd1Ee2Ff3Gg4Hh5Ii"
          },
          {
            "issuer_index": 4,
            "R": "Az1Xs3Cd5Vf7Bg9Nq1We3Rt5Yy7Ui9Op1Al3Sk5Dn7F",
            "s": "Tt1Uu2Vv3Ww4Xx5Yy6Zz7Aa8Bb9Cc0Dd1Ee2Ff3Gg4Hh"
          }
        ],
        "created_at": "2026-02-09T19:33:00.000Z"
      },
      "receipt": {
        "receipt_id": "fixture-receipt-invalid-signature",
        "election_id": "poc-2026-local-walkthrough",
        "manifest_id": "poc-2026-local-manifest",
        "ballot_hash": "0x2a7be1c5442f2a2d6c8fb1765ba993c6c2fd8b519ead31465fd5a765432111ee",
        "bb_leaf_hash": "0x0000000000000000000000000000000000000000000000000000000000000000",
        "bb_sth": {
          "tree_size": 0,
          "root_hash": "0x0000000000000000000000000000000000000000000000000000000000000000",
          "timestamp": "2026-02-10T00:00:00.000Z",
          "kid": "bb-dev-001",
          "sig": "MEQCIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiEAzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz"
        },
        "votechain_anchor": {
          "tx_id": "0x0000000000000000000000000000000000000000000000000000000000000000",
          "event_type": "ewp_ballot_cast",
          "sth_root_hash": "0x0000000000000000000000000000000000000000000000000000000000000000"
        },
        "ledger_acks": [],
        "kid": "ewp-gateway-1",
        "sig": "MEQCIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiEA7777777777777777777777777777777777777777"
      },
      "metadata": {
        "title": "Invalid blind signature should be quarantined",
        "summary": "Blind Schnorr signature mutated after issuance to simulate tampering. Worker must refuse to store or cast it and should emit fraud_flag invalid_signature.",
        "fr_refs": ["FR-1", "FR-3"],
        "tags": ["invalid", "forgery"],
        "notes": [
          "Receipt object intentionally contains zero hashes to make tampering obvious.",
          "Any appearance of this bundle in D1 should flip the worker into STATE_DIRTY."
        ],
        "expectation": "Status stays INVALID forever; attempts to cast must fail with FIXTURE_INVALID_SIGNATURE."
      },
      "audit": {
        "created_by": "scripts/playwright-setup-walkthrough.mjs",
        "reason": "Regression vector for forged credential guardrails",
        "last_verified_at": "2026-02-13T23:19:55.000Z"
      },
      "invalid_reason": "Blind signature values do not verify",
      "expected_error_code": "FIXTURE_INVALID_SIGNATURE"
    }
  ]
}
